// ==UserScript==
// @name         Doc: Nations
// @namespace    https://politicsandwar.com/nation/id=19818
// @version      10.0.0
// @description  Improves the Nations page UI
// @author       BlackAsLight
// @match        https://politicsandwar.com/nations/
// @include      https://politicsandwar.com/index.php?id=15*
// @icon         https://avatars.githubusercontent.com/u/44320105
// @grant        none
// ==/UserScript==
'use strict';
function a(n,e,i){let t=document.createElement(n);if(typeof e=="function")e(t);else if(e){for(let[o,r]of Object.entries(e))r!=null&&(t[o]=r);i&&i(t)}return t}if(document.querySelector("#Doc_Nations"))throw Error("This script was already injected...");document.body.append(a("div",{id:"Doc_Nations"},n=>n.style.setProperty("display","none")));var s="Doc_N1",l="Doc_N2",p=document.querySelector('form[method="GET"]');p.parentElement?.insertBefore(a("div",n=>n.append(a("label",{htmlFor:"Doc_Score",textContent:"Nation Score:"}),a("input",{id:"Doc_Score",type:"number",value:localStorage.getItem(s)??"0"},e=>e.addEventListener("change",function(i){if(this.valueAsNumber.toString()==="NaN")return;let t=new Date;this.nextSibling&&(this.nextSibling.textContent=t.toJSON()),localStorage.setItem(l,t.getTime().toString()),localStorage.setItem(s,this.valueAsNumber.toString()),m(this.valueAsNumber)})),a("br"),new Date(parseInt(localStorage.getItem(l)??"0")).toJSON(),a("button",{className:"btn btn-primary",textContent:"Refresh"},e=>{e.addEventListener("click",async function(i){this.disabled=!0;let t=parseFloat(new DOMParser().parseFromString(await(await fetch("https://politicsandwar.com/nation/war/")).text(),"text/html").querySelector('a[href^="/index.php?id=15"]').href.split("?")[1].split("&").find(r=>r.startsWith("keyword="))?.slice(8)??"0");console.log(`Score: ${t}`);let o=new Date;this.previousSibling&&(this.previousSibling.textContent=o.toJSON()),localStorage.setItem(l,`${o.getTime()}`),localStorage.setItem(s,`${t}`),m(t),this.previousElementSibling.previousElementSibling.valueAsNumber=t,this.disabled=!1}),e.style.setProperty("margin-inline","0.5em")}))),p.nextElementSibling);m(parseFloat(localStorage.getItem(s)??"0"));function u(n,e){return e*.4<=n&&n<=e*2.5}function c(n,e){return e*.75<=n&&n<=e*1.75}function m(n){[...document.querySelectorAll(".nationtable tr")].slice(1).forEach(e=>{let i=e.lastElementChild,t=parseFloat(i.lastChild.textContent.replaceAll(",",""));[...i.querySelectorAll("img")].forEach(o=>{o.src!=="https://politicsandwar.com/img/icons/16/plus_shield.png"&&o.remove()}),u(t,n)&&i.insertBefore(a("img",{src:"https://politicsandwar.com/img/icons/16/emotion_spy.png"}),i.lastChild),c(t,n)?c(n,t)?i.insertBefore(a("img",{src:"https://docscripts.stagintin.com/icons/green_red.png"}),i.lastChild):i.insertBefore(a("img",{src:"https://docscripts.stagintin.com/icons/green.png"}),i.lastChild):c(n,t)&&i.insertBefore(a("img",{src:"https://docscripts.stagintin.com/icons/red.png"}),i.lastChild)})}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiaHR0cHM6Ly9qc3IuaW8vQGRvY3Rvci9jcmVhdGUtdGFnLzAuMi4wL21vZC50cyIsICIuLi8uLi9zcmMvTmF0aW9ucy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLyoqXG4gKiBAbW9kdWxlXG4gKi9cblxuLyoqXG4gKiBBIHR5cGUgZm9yIGEgZ2l2ZW4gSFRNTEVsZW1lbnQgdGhhdCBmaWx0ZXJzIHRoZSBhdmFpbGFibGUgYXR0cmlidXRlcyB0b1xuICogdmFsdWVzIG9mIHR5cGUgc3RyaW5nLCBudW1iZXIsIG9yIGJvb2xlYW4uXG4gKlxuICogQGV4YW1wbGUgVXNhZ2VcbiAqIGBgYHRzXG4gKiB0eXBlIElucHV0QXR0cmlidXRlcyA9IEF0dHJpYnV0ZXM8J2lucHV0Jz5cbiAqIGBgYFxuICovXG5leHBvcnQgdHlwZSBBdHRyaWJ1dGVzPFQgZXh0ZW5kcyBrZXlvZiBIVE1MRWxlbWVudFRhZ05hbWVNYXA+ID0gUGFydGlhbDxcblx0e1xuXHRcdFtcblx0XHRcdFUgaW4ga2V5b2YgSFRNTEVsZW1lbnRUYWdOYW1lTWFwW1RdIGFzIEhUTUxFbGVtZW50VGFnTmFtZU1hcFtUXVtVXSBleHRlbmRzIHN0cmluZyB8IG51bWJlciB8IGJvb2xlYW4gfCBudWxsID8gVVxuXHRcdFx0XHQ6IG5ldmVyXG5cdFx0XTogSFRNTEVsZW1lbnRUYWdOYW1lTWFwW1RdW1VdXG5cdH1cbj5cblxuLyoqXG4gKiBBIHR5cGUgc3BlY2lmeWluZyB0aGUgc3RydWN0dXJlIG9mIHRoZSBmdW5jdGlvbiB0aGF0IGNhbiBiZSBwYXNzZWQgdG8gdGhlXG4gKiBjcmVhdGVUYWcgZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZSBVc2FnZVxuICogYGBgdHNcbiAqIHR5cGUgSW5wdXRGdW5jID0gRnVuYzwnaW5wdXQnPlxuICogYGBgXG4gKi9cbmV4cG9ydCB0eXBlIEZ1bmM8VCBleHRlbmRzIGtleW9mIEhUTUxFbGVtZW50VGFnTmFtZU1hcD4gPSAodGFnOiBIVE1MRWxlbWVudFRhZ05hbWVNYXBbVF0pID0+IHVua25vd25cblxuLyoqXG4gKiBBIGZ1bmN0aW9uIHRoYXQgY3JlYXRlcyBhIEhUTUxFbGVtZW50IHdpdGggdGhlIGNvcnJlY3QgdHlwaW5ncy5cbiAqXG4gKiBAcGFyYW0gdHlwZSBBIHN0cmluZyBjb250YWluaW5nIHRoZSBuYW1lIG9mIHRoZSBIVE1MIGVsZW1lbnQgdG8gYmUgY3JlYXRlZC5cbiAqIEBwYXJhbSBhdHRyaWJ1dGVzIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBrZXktdmFsdWUgcGFpcnMgb2YgYXR0cmlidXRlcyB0b1xuICogYmUgYXNzaWduZWQgdG8gdGhlIEhUTUwgZWxlbWVudC4gT25seSBzdHJpbmcsIG51bWJlciwgYW5kIGJvb2xlYW4gdmFsdWVzIGFyZVxuICogdmFsaWQuXG4gKiBAcGFyYW0gZnVuYyBBbiBvcHRpb25hbCBmdW5jdGlvbiB0aGF0IHBhc3NlcyB0aGUgY3JlYXRlZCBIVE1MIGVsZW1lbnQgYXMgYVxuICogcGFyYW1ldGVyIGJlZm9yZSByZXNvbHZpbmcgdGhlIGZ1bmN0aW9uLlxuICogQHJldHVybnMgQSBIVE1MIGVsZW1lbnQgYmFzZWQgb2ZmIHdoYXQgd2FzIHNwZWNpZmllZCBpbiB0eXBlLlxuICpcbiAqIEBleGFtcGxlIFVzYWdlXG4gKiBgYGB0c1xuICogY3JlYXRlVGFnKCdidXR0b24nLCB7IHRleHRDb250ZW50OiAnQ2xpY2sgTWUhJyB9LCBidXR0b25UYWcgPT5cbiAqICAgYnV0dG9uVGFnLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKF9ldmVudCkge1xuICogICAgIGNvbnNvbGUubG9nKHRoaXMub3V0ZXJIVE1MKVxuICogICB9KSkuY2xpY2soKVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUYWc8VCBleHRlbmRzIGtleW9mIEhUTUxFbGVtZW50VGFnTmFtZU1hcD4oXG5cdHR5cGU6IFQsXG5cdGF0dHJpYnV0ZXM6IEF0dHJpYnV0ZXM8VD4sXG5cdGZ1bmM/OiBGdW5jPFQ+LFxuKTogSFRNTEVsZW1lbnRUYWdOYW1lTWFwW1RdXG4vKipcbiAqIEEgZnVuY3Rpb24gdGhhdCBjcmVhdGVzIGEgSFRNTEVsZW1lbnQgd2l0aCB0aGUgY29ycmVjdCB0eXBpbmdzLlxuICpcbiAqIEBwYXJhbSB0eXBlIEEgc3RyaW5nIGNvbnRhaW5pbmcgdGhlIG5hbWUgb2YgdGhlIEhUTUwgZWxlbWVudCB0byBiZSBjcmVhdGVkLlxuICogQHBhcmFtIGZ1bmMgQW4gb3B0aW9uYWwgZnVuY3Rpb24gdGhhdCBwYXNzZXMgdGhlIGNyZWF0ZWQgSFRNTCBlbGVtZW50IGFzIGFcbiAqIHBhcmFtZXRlciBiZWZvcmUgcmVzb2x2aW5nIHRoZSBmdW5jdGlvbi5cbiAqIEByZXR1cm5zIEEgSFRNTCBlbGVtZW50IGJhc2VkIG9mZiB3aGF0IHdhcyBzcGVjaWZpZWQgaW4gdHlwZS5cbiAqXG4gKiBAZXhhbXBsZSBVc2FnZVxuICogYGBgdHNcbiAqIGNyZWF0ZVRhZygnYnV0dG9uJywgYnV0dG9uVGFnID0+XG4gKiAgIGJ1dHRvblRhZy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChfZXZlbnQpIHtcbiAqICAgICBjb25zb2xlLmxvZyhcIkkndmUgYmVlbiBjbGlja2VkIVwiKVxuICogICB9KSlcbiAqIGBgYFxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGFnPFQgZXh0ZW5kcyBrZXlvZiBIVE1MRWxlbWVudFRhZ05hbWVNYXA+KHR5cGU6IFQsIGZ1bmM/OiBGdW5jPFQ+KTogSFRNTEVsZW1lbnRUYWdOYW1lTWFwW1RdXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVGFnPFQgZXh0ZW5kcyBrZXlvZiBIVE1MRWxlbWVudFRhZ05hbWVNYXA+KFxuXHRhcmcxOiBULFxuXHRhcmcyPzogQXR0cmlidXRlczxUPiB8IEZ1bmM8VD4sXG5cdGFyZzM/OiBGdW5jPFQ+LFxuKTogSFRNTEVsZW1lbnRUYWdOYW1lTWFwW1RdIHtcblx0Y29uc3QgdGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChhcmcxKVxuXHRpZiAodHlwZW9mIGFyZzIgPT09ICdmdW5jdGlvbicpIHtcblx0XHRhcmcyKHRhZylcblx0fSBlbHNlIGlmIChhcmcyKSB7XG5cdFx0Zm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoYXJnMikpIHtcblx0XHRcdGlmICh2YWx1ZSAhPSBudWxsKSB7XG5cdFx0XHRcdHRhZ1trZXkgYXMgJ2lkJ10gPSB2YWx1ZSBhcyBzdHJpbmdcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKGFyZzMpIHtcblx0XHRcdGFyZzModGFnKVxuXHRcdH1cblx0fVxuXHRyZXR1cm4gdGFnXG59XG4iLCAiLy8gPT1Vc2VyU2NyaXB0PT1cbi8vIEBuYW1lICAgICAgICAgRG9jOiBOYXRpb25zXG4vLyBAbmFtZXNwYWNlICAgIGh0dHBzOi8vcG9saXRpY3NhbmR3YXIuY29tL25hdGlvbi9pZD0xOTgxOFxuLy8gQHZlcnNpb24gICAgICAxMC4wLjBcbi8vIEBkZXNjcmlwdGlvbiAgSW1wcm92ZXMgdGhlIE5hdGlvbnMgcGFnZSBVSVxuLy8gQGF1dGhvciAgICAgICBCbGFja0FzTGlnaHRcbi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly9wb2xpdGljc2FuZHdhci5jb20vbmF0aW9ucy9cbi8vIEBpbmNsdWRlICAgICAgaHR0cHM6Ly9wb2xpdGljc2FuZHdhci5jb20vaW5kZXgucGhwP2lkPTE1KlxuLy8gQGljb24gICAgICAgICBodHRwczovL2F2YXRhcnMuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3UvNDQzMjAxMDVcbi8vIEBncmFudCAgICAgICAgbm9uZVxuLy8gPT0vVXNlclNjcmlwdD09XG5cbmltcG9ydCB7IGNyZWF0ZVRhZyB9IGZyb20gXCJAZG9jdG9yL2NyZWF0ZS10YWdcIjtcblxuLyogRG91YmxlIEluamVjdGlvbiBQcm90ZWN0aW9uXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbmlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI0RvY19OYXRpb25zXCIpKSB7XG4gIHRocm93IEVycm9yKFwiVGhpcyBzY3JpcHQgd2FzIGFscmVhZHkgaW5qZWN0ZWQuLi5cIik7XG59XG5kb2N1bWVudC5ib2R5LmFwcGVuZChcbiAgY3JlYXRlVGFnKFxuICAgIFwiZGl2XCIsXG4gICAgeyBpZDogXCJEb2NfTmF0aW9uc1wiIH0sXG4gICAgKGRpdlRhZykgPT4gZGl2VGFnLnN0eWxlLnNldFByb3BlcnR5KFwiZGlzcGxheVwiLCBcIm5vbmVcIiksXG4gICksXG4pO1xuXG4vKiBHbG9iYWwgVmFyaWFibGVzXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbmNvbnN0IHNjb3JlS2V5ID0gXCJEb2NfTjFcIjtcbmNvbnN0IHRpY2tzS2V5ID0gXCJEb2NfTjJcIjtcblxuLyogTWFpblxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5jb25zdCBmb3JtVGFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybVttZXRob2Q9XCJHRVRcIl0nKSBhcyBIVE1MRm9ybUVsZW1lbnQ7XG5mb3JtVGFnLnBhcmVudEVsZW1lbnQ/Lmluc2VydEJlZm9yZShcbiAgY3JlYXRlVGFnKFwiZGl2XCIsIChkaXZUYWcpID0+XG4gICAgZGl2VGFnLmFwcGVuZChcbiAgICAgIGNyZWF0ZVRhZyhcImxhYmVsXCIsIHtcbiAgICAgICAgaHRtbEZvcjogXCJEb2NfU2NvcmVcIixcbiAgICAgICAgdGV4dENvbnRlbnQ6IFwiTmF0aW9uIFNjb3JlOlwiLFxuICAgICAgfSksXG4gICAgICBjcmVhdGVUYWcoXCJpbnB1dFwiLCB7XG4gICAgICAgIGlkOiBcIkRvY19TY29yZVwiLFxuICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICB2YWx1ZTogbG9jYWxTdG9yYWdlLmdldEl0ZW0oc2NvcmVLZXkpID8/IFwiMFwiLFxuICAgICAgfSwgKGlucHV0VGFnKSA9PlxuICAgICAgICBpbnB1dFRhZy5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGZ1bmN0aW9uIChfZXZlbnQpOiB2b2lkIHtcbiAgICAgICAgICBpZiAodGhpcy52YWx1ZUFzTnVtYmVyLnRvU3RyaW5nKCkgPT09IFwiTmFOXCIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgaWYgKHRoaXMubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dFNpYmxpbmcudGV4dENvbnRlbnQgPSBkYXRlLnRvSlNPTigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aWNrc0tleSwgZGF0ZS5nZXRUaW1lKCkudG9TdHJpbmcoKSk7XG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc2NvcmVLZXksIHRoaXMudmFsdWVBc051bWJlci50b1N0cmluZygpKTtcbiAgICAgICAgICB1cGRhdGVJY29ucyh0aGlzLnZhbHVlQXNOdW1iZXIpO1xuICAgICAgICB9KSksXG4gICAgICBjcmVhdGVUYWcoXCJiclwiKSxcbiAgICAgIG5ldyBEYXRlKHBhcnNlSW50KGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRpY2tzS2V5KSA/PyBcIjBcIikpLnRvSlNPTigpLFxuICAgICAgY3JlYXRlVGFnKFwiYnV0dG9uXCIsIHtcbiAgICAgICAgY2xhc3NOYW1lOiBcImJ0biBidG4tcHJpbWFyeVwiLFxuICAgICAgICB0ZXh0Q29udGVudDogXCJSZWZyZXNoXCIsXG4gICAgICB9LCAoYnV0dG9uVGFnKSA9PiB7XG4gICAgICAgIGJ1dHRvblRhZy5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgIFwiY2xpY2tcIixcbiAgICAgICAgICBhc3luYyBmdW5jdGlvbiAoX2V2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHNjb3JlID0gcGFyc2VGbG9hdChcbiAgICAgICAgICAgICAgbmV3IERPTVBhcnNlcigpXG4gICAgICAgICAgICAgICAgLnBhcnNlRnJvbVN0cmluZyhcbiAgICAgICAgICAgICAgICAgIGF3YWl0IChhd2FpdCBmZXRjaChcImh0dHBzOi8vcG9saXRpY3NhbmR3YXIuY29tL25hdGlvbi93YXIvXCIpKVxuICAgICAgICAgICAgICAgICAgICAudGV4dCgpLFxuICAgICAgICAgICAgICAgICAgXCJ0ZXh0L2h0bWxcIixcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3I8SFRNTEFuY2hvckVsZW1lbnQ+KFxuICAgICAgICAgICAgICAgICAgJ2FbaHJlZl49XCIvaW5kZXgucGhwP2lkPTE1XCJdJyxcbiAgICAgICAgICAgICAgICApIVxuICAgICAgICAgICAgICAgIC5ocmVmXG4gICAgICAgICAgICAgICAgLnNwbGl0KFwiP1wiKVsxXVxuICAgICAgICAgICAgICAgIC5zcGxpdChcIiZcIilcbiAgICAgICAgICAgICAgICAuZmluZCgoYXJnKSA9PlxuICAgICAgICAgICAgICAgICAgYXJnLnN0YXJ0c1dpdGgoXCJrZXl3b3JkPVwiKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICA/LnNsaWNlKDgpID8/XG4gICAgICAgICAgICAgICAgXCIwXCIsXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFNjb3JlOiAke3Njb3JlfWApO1xuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgICAgICAgdGhpcy5wcmV2aW91c1NpYmxpbmcudGV4dENvbnRlbnQgPSBkYXRlLnRvSlNPTigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGlja3NLZXksIGAke2RhdGUuZ2V0VGltZSgpfWApO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc2NvcmVLZXksIGAke3Njb3JlfWApO1xuICAgICAgICAgICAgdXBkYXRlSWNvbnMoc2NvcmUpO1xuICAgICAgICAgICAgKHRoaXMucHJldmlvdXNFbGVtZW50U2libGluZyFcbiAgICAgICAgICAgICAgLnByZXZpb3VzRWxlbWVudFNpYmxpbmcgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWVBc051bWJlciA9XG4gICAgICAgICAgICAgICAgc2NvcmU7XG4gICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICAgICAgYnV0dG9uVGFnLnN0eWxlLnNldFByb3BlcnR5KFwibWFyZ2luLWlubGluZVwiLCBcIjAuNWVtXCIpO1xuICAgICAgfSksXG4gICAgKSksXG4gIGZvcm1UYWcubmV4dEVsZW1lbnRTaWJsaW5nLFxuKTtcbnVwZGF0ZUljb25zKHBhcnNlRmxvYXQobG9jYWxTdG9yYWdlLmdldEl0ZW0oc2NvcmVLZXkpID8/IFwiMFwiKSk7XG5cbi8qIEZ1bmN0aW9uc1xuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5mdW5jdGlvbiBpblNweVJhbmdlKHNjb3JlOiBudW1iZXIsIHJhbmdlU2NvcmU6IG51bWJlcik6IGJvb2xlYW4ge1xuICByZXR1cm4gcmFuZ2VTY29yZSAqIDAuNCA8PSBzY29yZSAmJiBzY29yZSA8PSByYW5nZVNjb3JlICogMi41O1xufVxuXG5mdW5jdGlvbiBpbldhclJhbmdlKHNjb3JlOiBudW1iZXIsIHJhbmdlU2NvcmU6IG51bWJlcik6IGJvb2xlYW4ge1xuICByZXR1cm4gcmFuZ2VTY29yZSAqIDAuNzUgPD0gc2NvcmUgJiYgc2NvcmUgPD0gcmFuZ2VTY29yZSAqIDEuNzU7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUljb25zKG15U2NvcmU6IG51bWJlcik6IHZvaWQge1xuICBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbDxIVE1MVGFibGVSb3dFbGVtZW50PihcbiAgICBcIi5uYXRpb250YWJsZSB0clwiLFxuICApXS5zbGljZSgxKS5mb3JFYWNoKCh0clRhZykgPT4ge1xuICAgIGNvbnN0IHRkVGFnID0gdHJUYWcubGFzdEVsZW1lbnRDaGlsZCBhcyBIVE1MVGFibGVDZWxsRWxlbWVudDtcbiAgICBjb25zdCB0aGVpclNjb3JlID0gcGFyc2VGbG9hdChcbiAgICAgIHRkVGFnLmxhc3RDaGlsZCEudGV4dENvbnRlbnQhLnJlcGxhY2VBbGwoXCIsXCIsIFwiXCIpLFxuICAgICk7XG4gICAgWy4uLnRkVGFnLnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTEltYWdlRWxlbWVudD4oXCJpbWdcIildLmZvckVhY2goKGltZ1RhZykgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBpbWdUYWcuc3JjID09PSBcImh0dHBzOi8vcG9saXRpY3NhbmR3YXIuY29tL2ltZy9pY29ucy8xNi9wbHVzX3NoaWVsZC5wbmdcIlxuICAgICAgKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGltZ1RhZy5yZW1vdmUoKTtcbiAgICB9KTtcbiAgICBpZiAoaW5TcHlSYW5nZSh0aGVpclNjb3JlLCBteVNjb3JlKSkge1xuICAgICAgdGRUYWcuaW5zZXJ0QmVmb3JlKFxuICAgICAgICBjcmVhdGVUYWcoXCJpbWdcIiwge1xuICAgICAgICAgIHNyYzogXCJodHRwczovL3BvbGl0aWNzYW5kd2FyLmNvbS9pbWcvaWNvbnMvMTYvZW1vdGlvbl9zcHkucG5nXCIsXG4gICAgICAgIH0pLFxuICAgICAgICB0ZFRhZy5sYXN0Q2hpbGQsXG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoaW5XYXJSYW5nZSh0aGVpclNjb3JlLCBteVNjb3JlKSkge1xuICAgICAgaWYgKGluV2FyUmFuZ2UobXlTY29yZSwgdGhlaXJTY29yZSkpIHtcbiAgICAgICAgdGRUYWcuaW5zZXJ0QmVmb3JlKFxuICAgICAgICAgIGNyZWF0ZVRhZyhcImltZ1wiLCB7XG4gICAgICAgICAgICBzcmM6IFwiaHR0cHM6Ly9kb2NzY3JpcHRzLnN0YWdpbnRpbi5jb20vaWNvbnMvZ3JlZW5fcmVkLnBuZ1wiLFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHRkVGFnLmxhc3RDaGlsZCxcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRkVGFnLmluc2VydEJlZm9yZShcbiAgICAgICAgICBjcmVhdGVUYWcoXCJpbWdcIiwge1xuICAgICAgICAgICAgc3JjOiBcImh0dHBzOi8vZG9jc2NyaXB0cy5zdGFnaW50aW4uY29tL2ljb25zL2dyZWVuLnBuZ1wiLFxuICAgICAgICAgIH0pLFxuICAgICAgICAgIHRkVGFnLmxhc3RDaGlsZCxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGluV2FyUmFuZ2UobXlTY29yZSwgdGhlaXJTY29yZSkpIHtcbiAgICAgIHRkVGFnLmluc2VydEJlZm9yZShcbiAgICAgICAgY3JlYXRlVGFnKFwiaW1nXCIsIHtcbiAgICAgICAgICBzcmM6IFwiaHR0cHM6Ly9kb2NzY3JpcHRzLnN0YWdpbnRpbi5jb20vaWNvbnMvcmVkLnBuZ1wiLFxuICAgICAgICB9KSxcbiAgICAgICAgdGRUYWcubGFzdENoaWxkLFxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xufVxuIl0sCiAgIm1hcHBpbmdzIjogIkFBMEVPLFNBQVNBLEVBQ2ZDLEVBQ0FDLEVBQ0FDLEVBQzJCLENBQzNCLElBQU1DLEVBQU0sU0FBUyxjQUFjSCxDQUFJLEVBQ3ZDLEdBQUksT0FBT0MsR0FBUyxXQUNuQkEsRUFBS0UsQ0FBRyxVQUNFRixFQUFNLENBQ2hCLE9BQVcsQ0FBQ0csRUFBS0MsQ0FBSyxJQUFLLE9BQU8sUUFBUUosQ0FBSSxFQUN6Q0ksR0FBUyxPQUNaRixFQUFJQyxDQUFXLEVBQUlDLEdBR2pCSCxHQUNIQSxFQUFLQyxDQUFHLENBRVYsQ0FDQSxPQUFPQSxDQUNSLENDN0VBLEdBQUksU0FBUyxjQUFjLGNBQWMsRUFDdkMsTUFBTSxNQUFNLHFDQUFxQyxFQUVuRCxTQUFTLEtBQUssT0FDWkcsRUFDRSxNQUNBLENBQUUsR0FBSSxhQUFjLEVBQ25CQyxHQUFXQSxFQUFPLE1BQU0sWUFBWSxVQUFXLE1BQU0sQ0FDeEQsQ0FDRixFQUlBLElBQU1DLEVBQVcsU0FDWEMsRUFBVyxTQUlYQyxFQUFVLFNBQVMsY0FBYyxvQkFBb0IsRUFDM0RBLEVBQVEsZUFBZSxhQUNyQkosRUFBVSxNQUFRQyxHQUNoQkEsRUFBTyxPQUNMRCxFQUFVLFFBQVMsQ0FDakIsUUFBUyxZQUNULFlBQWEsZUFDZixDQUFDLEVBQ0RBLEVBQVUsUUFBUyxDQUNqQixHQUFJLFlBQ0osS0FBTSxTQUNOLE1BQU8sYUFBYSxRQUFRRSxDQUFRLEdBQUssR0FDM0MsRUFBSUcsR0FDRkEsRUFBUyxpQkFBaUIsU0FBVSxTQUFVQyxFQUFjLENBQzFELEdBQUksS0FBSyxjQUFjLFNBQVMsSUFBTSxNQUNwQyxPQUVGLElBQU1DLEVBQU8sSUFBSSxLQUNiLEtBQUssY0FDUCxLQUFLLFlBQVksWUFBY0EsRUFBSyxPQUFPLEdBRTdDLGFBQWEsUUFBUUosRUFBVUksRUFBSyxRQUFRLEVBQUUsU0FBUyxDQUFDLEVBQ3hELGFBQWEsUUFBUUwsRUFBVSxLQUFLLGNBQWMsU0FBUyxDQUFDLEVBQzVETSxFQUFZLEtBQUssYUFBYSxDQUNoQyxDQUFDLENBQUMsRUFDSlIsRUFBVSxJQUFJLEVBQ2QsSUFBSSxLQUFLLFNBQVMsYUFBYSxRQUFRRyxDQUFRLEdBQUssR0FBRyxDQUFDLEVBQUUsT0FBTyxFQUNqRUgsRUFBVSxTQUFVLENBQ2xCLFVBQVcsa0JBQ1gsWUFBYSxTQUNmLEVBQUlTLEdBQWMsQ0FDaEJBLEVBQVUsaUJBQ1IsUUFDQSxlQUFnQkgsRUFBdUIsQ0FDckMsS0FBSyxTQUFXLEdBQ2hCLElBQU1JLEVBQVEsV0FDWixJQUFJLFVBQVUsRUFDWCxnQkFDQyxNQUFPLE1BQU0sTUFBTSx3Q0FBd0MsR0FDeEQsS0FBSyxFQUNSLFdBQ0YsRUFDQyxjQUNDLDZCQUNGLEVBQ0MsS0FDQSxNQUFNLEdBQUcsRUFBRSxDQUFDLEVBQ1osTUFBTSxHQUFHLEVBQ1QsS0FBTUMsR0FDTEEsRUFBSSxXQUFXLFVBQVUsQ0FDM0IsR0FDRSxNQUFNLENBQUMsR0FDVCxHQUNKLEVBQ0EsUUFBUSxJQUFJLFVBQVVELENBQUssRUFBRSxFQUM3QixJQUFNSCxFQUFPLElBQUksS0FDYixLQUFLLGtCQUNQLEtBQUssZ0JBQWdCLFlBQWNBLEVBQUssT0FBTyxHQUVqRCxhQUFhLFFBQVFKLEVBQVUsR0FBR0ksRUFBSyxRQUFRLENBQUMsRUFBRSxFQUNsRCxhQUFhLFFBQVFMLEVBQVUsR0FBR1EsQ0FBSyxFQUFFLEVBQ3pDRixFQUFZRSxDQUFLLEVBQ2hCLEtBQUssdUJBQ0gsdUJBQTRDLGNBQzNDQSxFQUNKLEtBQUssU0FBVyxFQUNsQixDQUNGLEVBQ0FELEVBQVUsTUFBTSxZQUFZLGdCQUFpQixPQUFPLENBQ3RELENBQUMsQ0FDSCxDQUFDLEVBQ0hMLEVBQVEsa0JBQ1YsRUFDQUksRUFBWSxXQUFXLGFBQWEsUUFBUU4sQ0FBUSxHQUFLLEdBQUcsQ0FBQyxFQUk3RCxTQUFTVSxFQUFXRixFQUFlRyxFQUE2QixDQUM5RCxPQUFPQSxFQUFhLElBQU9ILEdBQVNBLEdBQVNHLEVBQWEsR0FDNUQsQ0FFQSxTQUFTQyxFQUFXSixFQUFlRyxFQUE2QixDQUM5RCxPQUFPQSxFQUFhLEtBQVFILEdBQVNBLEdBQVNHLEVBQWEsSUFDN0QsQ0FFQSxTQUFTTCxFQUFZTyxFQUF1QixDQUMxQyxDQUFDLEdBQUcsU0FBUyxpQkFDWCxpQkFDRixDQUFDLEVBQUUsTUFBTSxDQUFDLEVBQUUsUUFBU0MsR0FBVSxDQUM3QixJQUFNQyxFQUFRRCxFQUFNLGlCQUNkRSxFQUFhLFdBQ2pCRCxFQUFNLFVBQVcsWUFBYSxXQUFXLElBQUssRUFBRSxDQUNsRCxFQUNBLENBQUMsR0FBR0EsRUFBTSxpQkFBbUMsS0FBSyxDQUFDLEVBQUUsUUFBU0UsR0FBVyxDQUVyRUEsRUFBTyxNQUFRLDJEQUlqQkEsRUFBTyxPQUFPLENBQ2hCLENBQUMsRUFDR1AsRUFBV00sRUFBWUgsQ0FBTyxHQUNoQ0UsRUFBTSxhQUNKakIsRUFBVSxNQUFPLENBQ2YsSUFBSyx5REFDUCxDQUFDLEVBQ0RpQixFQUFNLFNBQ1IsRUFFRUgsRUFBV0ksRUFBWUgsQ0FBTyxFQUM1QkQsRUFBV0MsRUFBU0csQ0FBVSxFQUNoQ0QsRUFBTSxhQUNKakIsRUFBVSxNQUFPLENBQ2YsSUFBSyxzREFDUCxDQUFDLEVBQ0RpQixFQUFNLFNBQ1IsRUFFQUEsRUFBTSxhQUNKakIsRUFBVSxNQUFPLENBQ2YsSUFBSyxrREFDUCxDQUFDLEVBQ0RpQixFQUFNLFNBQ1IsRUFFT0gsRUFBV0MsRUFBU0csQ0FBVSxHQUN2Q0QsRUFBTSxhQUNKakIsRUFBVSxNQUFPLENBQ2YsSUFBSyxnREFDUCxDQUFDLEVBQ0RpQixFQUFNLFNBQ1IsQ0FFSixDQUFDLENBQ0giLAogICJuYW1lcyI6IFsiY3JlYXRlVGFnIiwgImFyZzEiLCAiYXJnMiIsICJhcmczIiwgInRhZyIsICJrZXkiLCAidmFsdWUiLCAiY3JlYXRlVGFnIiwgImRpdlRhZyIsICJzY29yZUtleSIsICJ0aWNrc0tleSIsICJmb3JtVGFnIiwgImlucHV0VGFnIiwgIl9ldmVudCIsICJkYXRlIiwgInVwZGF0ZUljb25zIiwgImJ1dHRvblRhZyIsICJzY29yZSIsICJhcmciLCAiaW5TcHlSYW5nZSIsICJyYW5nZVNjb3JlIiwgImluV2FyUmFuZ2UiLCAibXlTY29yZSIsICJ0clRhZyIsICJ0ZFRhZyIsICJ0aGVpclNjb3JlIiwgImltZ1RhZyJdCn0K
