// ==UserScript==
// @name         Doc: Nations
// @namespace    https://politicsandwar.com/nation/id=19818
// @version      0.1
// @description  Improves the Nations page UI
// @author       BlackAsLight
// @match        https://politicsandwar.com/nations/
// @include      https://politicsandwar.com/index.php?id=15*
// @icon         https://avatars.githubusercontent.com/u/44320105
// @grant        none
// ==/UserScript==
'use strict';
(()=>{function a(t,e=null,...n){if(typeof t!="string")return t(e,...n);let o=document.createElement(t);return e&&Object.entries(e).forEach(([i,l])=>typeof l=="boolean"?o.toggleAttribute(i,l):o.setAttribute(i,l)),n.flat().forEach(async i=>{if(i==null)return;if(i.toString()!=="[object Promise]")return o.append(i);let l=a("div",null);o.append(l),i=await i,l.parentElement&&(l.parentElement.insertBefore(i,l),l.remove())}),o}var c;(function(t){t[t.Money=0]="Money",t[t.Oil=1]="Oil",t[t.Coal=2]="Coal",t[t.Iron=3]="Iron",t[t.Bauxite=4]="Bauxite",t[t.Lead=5]="Lead",t[t.Uranium=6]="Uranium",t[t.Food=7]="Food",t[t.Gasoline=8]="Gasoline",t[t.Steel=9]="Steel",t[t.Aluminum=10]="Aluminum",t[t.Munitions=11]="Munitions",t[t.Credits=12]="Credits"})(c||(c={}));function p(t,e){return e(t),t}if(document.querySelector("#Doc_Nations"))throw Error("This script was already injected...");document.body.append(a("div",{id:"Doc_Nations",style:"display: none;"}));var s="Doc_N1",d="Doc_N2",m=document.querySelector('form[method="GET"]');m.parentElement?.insertBefore(a("div",null,a("label",{for:"Doc_Score"},"Nation Score: "),p(a("input",{id:"Doc_Score",type:"number",value:localStorage.getItem(s)??0}),t=>t.addEventListener("change",e=>{let n=e.target,o=parseFloat(n.value);if(`${o}`=="NaN")return;let i=new Date;n.nextSibling&&(n.nextSibling.textContent=i.toJSON()),localStorage.setItem(d,`${i.getTime()}`),localStorage.setItem(s,`${o}`),f(o)})),a("br",null),new Date(parseInt(localStorage.getItem(d)??"0")).toJSON()),m.nextElementSibling);f(parseFloat(localStorage.getItem(s)??"0"));function g(t,e){return e*.4<=t&&t<=e*2.5}function r(t,e){return e*.75<=t&&t<=e*1.75}function f(t){[...document.querySelectorAll(".nationtable tr")].slice(1).forEach(e=>{let n=e.lastElementChild,o=parseFloat(n.lastChild?.textContent?.replaceAll(",",""));[...n.querySelectorAll("img")].forEach(i=>{i.src!=="https://politicsandwar.com/img/icons/16/plus_shield.png"&&i.remove()}),g(o,t)&&n.insertBefore(a("img",{src:"https://politicsandwar.com/img/icons/16/emotion_spy.png"}),n.lastChild),r(o,t)?r(t,o)?n.insertBefore(a("img",{src:"https://docscripts.stagintin.com/icons/green_red.png"}),n.lastChild):n.insertBefore(a("img",{src:"https://politicsandwar.com/img/icons/16/tick_shield.png"}),n.lastChild):r(t,o)&&n.insertBefore(a("img",{src:"https://docscripts.stagintin.com/icons/red.png"}),n.lastChild)})}})();
